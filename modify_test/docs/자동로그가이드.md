# í‚¤ì›€ì¦ê¶Œ ìë™ë§¤ë§¤ ë¡œê·¸ ì‹œìŠ¤í…œ ê°€ì´ë“œ

## ğŸ“ ë¡œê·¸ êµ¬ì¡°

```
logs/
â”œâ”€â”€ general/           # ì „ì²´ ë¡œê·¸
â”‚   â””â”€â”€ app_20250130.log
â”œâ”€â”€ trading/           # ë§¤ë§¤ ê´€ë ¨ ë¡œê·¸
â”‚   â””â”€â”€ trading_20250130.log
â”œâ”€â”€ tr_requests/       # TR ìš”ì²­ ë¡œê·¸
â”‚   â””â”€â”€ tr_requests_20250130.log
â”œâ”€â”€ websocket/         # ì›¹ì†Œì¼“ ë¡œê·¸
â”‚   â””â”€â”€ websocket_20250130.log
â”œâ”€â”€ orders/            # ì£¼ë¬¸ ê´€ë ¨ ë¡œê·¸
â”‚   â””â”€â”€ orders_20250130.log
â”œâ”€â”€ errors/            # ì—ëŸ¬ ë¡œê·¸
â”‚   â””â”€â”€ errors_20250130.log
â”œâ”€â”€ reports/           # ìë™ ìƒì„± ë¦¬í¬íŠ¸
â”‚   â””â”€â”€ daily_report_20250130.json
â””â”€â”€ charts/            # ìƒì„±ëœ ì°¨íŠ¸
    â””â”€â”€ trading_timeline_20250130.png
```

## ğŸš€ ì„¤ì¹˜ ë° ì„¤ì •

### 1. ìƒˆ íŒŒì¼ ìƒì„±

ê¸°ì¡´ í”„ë¡œì íŠ¸ì— ë‹¤ìŒ íŒŒì¼ë“¤ì„ ì¶”ê°€í•˜ì„¸ìš”:

1. **enhanced_logging.py** - ë¡œê¹… ì‹œìŠ¤í…œ ì½”ì–´
2. **log_analyzer.py** - ë¡œê·¸ ë¶„ì„ ë„êµ¬
3. **config.py** - ê¸°ì¡´ íŒŒì¼ì— ë¡œê¹… ì„¤ì • ì¶”ê°€
4. **utils.py, tr_process_functions.py, websocket_functions.py, kiwoom_rest_test1.py** - ë¡œê¹… ì ìš©

### 2. í•„ìš”í•œ íŒ¨í‚¤ì§€ ì„¤ì¹˜

```bash
pip install loguru pandas matplotlib seaborn
```

### 3. ê¸°ì¡´ ì½”ë“œ ìˆ˜ì •

ê¸°ì¡´ íŒŒì¼ë“¤ì˜ ë§¨ ìœ„ì— ë‹¤ìŒì„ ì¶”ê°€:

```python
from enhanced_logging import logger, log_trading, log_tr_request, log_websocket, log_order, log_error, log_info, log_debug
```

## ğŸ“ ë¡œê·¸ ì‚¬ìš©ë²•

### ê¸°ë³¸ ë¡œê¹… í•¨ìˆ˜ë“¤

```python
# ë§¤ë§¤ ê´€ë ¨ ë¡œê·¸
log_trading("ë§¤ìˆ˜ì£¼ë¬¸ ì„±ê³µ - ì‚¼ì„±ì „ì(005930), ìˆ˜ëŸ‰: 10ì£¼")
log_trading("ì†ì ˆ ë°œë™ - í˜„ì¬ ìˆ˜ìµë¥ : -3.2%", level="WARNING")

# TR ìš”ì²­ ë¡œê·¸
log_tr_request("ê³„ì¢Œì¡°íšŒ ìš”ì²­ ì‹œì‘")
log_tr_request("ì£¼ì‹ê¸°ë³¸ì •ë³´ ìš”ì²­ ì™„ë£Œ - 005930")

# ì›¹ì†Œì¼“ ë¡œê·¸
log_websocket("ì‹¤ì‹œê°„ ë“±ë¡: 005930")
log_websocket("ì¡°ê±´ê²€ìƒ‰ í¸ì…í¸ì¶œ - ì¢…ëª©: 005930")

# ì£¼ë¬¸ ë¡œê·¸
log_order("ì£¼ë¬¸ì ‘ìˆ˜ - ì‚¼ì„±ì „ì(005930), ì£¼ë¬¸ë²ˆí˜¸: 12345")
log_order("ì£¼ë¬¸ì²´ê²°ì™„ë£Œ - ì£¼ë¬¸ë²ˆí˜¸: 12345")

# ì—ëŸ¬ ë¡œê·¸
log_error("API í˜¸ì¶œ ì‹¤íŒ¨", exception=True)
log_error("ì—°ê²° ì˜¤ë¥˜ ë°œìƒ")

# ì¼ë°˜ ë¡œê·¸
log_info("í”„ë¡œê·¸ë¨ ì‹œì‘")
log_debug("ë””ë²„ê·¸ ì •ë³´")
```

### ë¡œê·¸ ë ˆë²¨ë³„ íŠ¹ì§•

- **DEBUG**: ê°œë°œìš© ìƒì„¸ ì •ë³´
- **INFO**: ì¼ë°˜ì ì¸ ì •ë³´
- **WARNING**: ê²½ê³ ì‚¬í•­
- **ERROR**: ì˜¤ë¥˜ ë°œìƒ

## ğŸ“Š ë¡œê·¸ ë¶„ì„ ì‚¬ìš©ë²•

### 1. ê¸°ë³¸ ë¶„ì„

```python
from log_analyzer import LogAnalyzer

# ë¶„ì„ê¸° ìƒì„±
analyzer = LogAnalyzer()

# ì˜¤ëŠ˜ ë¡œê·¸ ìš”ì•½ ì¶œë ¥
analyzer.print_summary()

# íŠ¹ì • ë‚ ì§œ ë¶„ì„
analyzer.print_summary(date="20250130")
```

### 2. ë§¤ë§¤ ì„±ê³¼ ë¶„ì„

```python
# ë§¤ë§¤ ë°ì´í„° ë¶„ì„
trading_data = analyzer.analyze_trading_performance()

if trading_data:
    print(f"ë§¤ìˆ˜ ê±´ìˆ˜: {len(trading_data['buy_orders'])}")
    print(f"ë§¤ë„ ê±´ìˆ˜: {len(trading_data['sell_orders'])}")
    print(f"ì´ ë§¤ìˆ˜ê¸ˆì•¡: {trading_data['summary']['total_buy_amount']:,}ì›")
```

### 3. ì—ëŸ¬ íŒ¨í„´ ë¶„ì„

```python
# ìµœê·¼ 7ì¼ê°„ ì—ëŸ¬ ë¶„ì„
error_data = analyzer.analyze_error_patterns(days_back=7)

print("ì—ëŸ¬ ìœ í˜•ë³„ ë°œìƒ íšŸìˆ˜:")
for error_type, count in error_data['summary'].items():
    print(f"  {error_type}: {count}ê±´")
```

### 4. ì‹œê°í™”

```python
# ë§¤ë§¤ íƒ€ì„ë¼ì¸ ì°¨íŠ¸ ìƒì„±
analyzer.plot_trading_timeline()

# íŠ¹ì • ë‚ ì§œ ì°¨íŠ¸
analyzer.plot_trading_timeline(date="20250130")
```

### 5. ì¼ì¼ ë¦¬í¬íŠ¸ ìƒì„±

```python
# JSON í˜•íƒœì˜ ìƒì„¸ ë¦¬í¬íŠ¸ ìƒì„±
report = analyzer.generate_daily_report()

# ë¦¬í¬íŠ¸ëŠ” logs/reports/ í´ë”ì— ìë™ ì €ì¥ë¨
```

## âš™ï¸ ë¡œê·¸ ì„¤ì • ì»¤ìŠ¤í„°ë§ˆì´ì§•

### config.pyì—ì„œ ì„¤ì • ë³€ê²½

```python
LOGGING_CONFIG = {
    "enable_trading_logs": True,      # ë§¤ë§¤ ë¡œê·¸ í™œì„±í™”
    "enable_tr_logs": True,           # TR ìš”ì²­ ë¡œê·¸ í™œì„±í™”
    "enable_websocket_logs": True,    # ì›¹ì†Œì¼“ ë¡œê·¸ í™œì„±í™”
    "enable_order_logs": True,        # ì£¼ë¬¸ ë¡œê·¸ í™œì„±í™”
    "enable_error_logs": True,        # ì—ëŸ¬ ë¡œê·¸ í™œì„±í™”
    "log_retention_days": {
        "general": 30,      # ì¼ë°˜ ë¡œê·¸ 30ì¼ ë³´ê´€
        "trading": 365,     # ë§¤ë§¤ ë¡œê·¸ 1ë…„ ë³´ê´€
        "tr_requests": 30,  # TR ìš”ì²­ ë¡œê·¸ 30ì¼ ë³´ê´€
        "websocket": 30,    # ì›¹ì†Œì¼“ ë¡œê·¸ 30ì¼ ë³´ê´€
        "orders": 180,      # ì£¼ë¬¸ ë¡œê·¸ 6ê°œì›” ë³´ê´€
        "errors": 90        # ì—ëŸ¬ ë¡œê·¸ 3ê°œì›” ë³´ê´€
    }
}
```

## ğŸ” ë¡œê·¸ ëª¨ë‹ˆí„°ë§ íŒ

### 1. ì‹¤ì‹œê°„ ë¡œê·¸ í™•ì¸

```bash
# íŠ¹ì • ë¡œê·¸ íŒŒì¼ ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§ (Linux/Mac)
tail -f logs/trading/trading_20250130.log

# ì—ëŸ¬ ë¡œê·¸ë§Œ ì‹¤ì‹œê°„ í™•ì¸
tail -f logs/errors/errors_20250130.log
```

### 2. ë¡œê·¸ ê²€ìƒ‰

```bash
# íŠ¹ì • ì¢…ëª©ì½”ë“œ ê´€ë ¨ ë¡œê·¸ ê²€ìƒ‰
grep "005930" logs/trading/trading_20250130.log

# ì—ëŸ¬ ë¡œê·¸ì—ì„œ íŠ¹ì • íŒ¨í„´ ê²€ìƒ‰
grep -i "http error" logs/errors/errors_20250130.log
```

### 3. ì •ê¸°ì ì¸ ë¡œê·¸ ë¶„ì„

```python
# ë§¤ì¼ ìë™ìœ¼ë¡œ ì‹¤í–‰í•  ìŠ¤í¬ë¦½íŠ¸ ì˜ˆì‹œ
import schedule
import time
from log_analyzer import LogAnalyzer

def daily_analysis():
    analyzer = LogAnalyzer()
    analyzer.generate_daily_report()
    analyzer.plot_trading_timeline()
    print("ì¼ì¼ ë¶„ì„ ì™„ë£Œ")

# ë§¤ì¼ ì˜¤í›„ 6ì‹œì— ì‹¤í–‰
schedule.every().day.at("18:00").do(daily_analysis)

while True:
    schedule.run_pending()
    time.sleep(60)
```

## ğŸ› ï¸ íŠ¸ëŸ¬ë¸”ìŠˆíŒ…

### ìì£¼ ë°œìƒí•˜ëŠ” ë¬¸ì œë“¤

1. **ë¡œê·¸ íŒŒì¼ì´ ìƒì„±ë˜ì§€ ì•ŠëŠ” ê²½ìš°**
   - `logs` í´ë” ê¶Œí•œ í™•ì¸
   - ë””ìŠ¤í¬ ìš©ëŸ‰ í™•ì¸
   - enhanced_logging.py ì„í¬íŠ¸ í™•ì¸

2. **í•œê¸€ ê¹¨ì§ í˜„ìƒ**
   - íŒŒì¼ ì¸ì½”ë”©ì´ UTF-8ë¡œ ì„¤ì •ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸
   - í…ìŠ¤íŠ¸ ì—ë””í„°ì˜ ì¸ì½”ë”© ì„¤ì • í™•ì¸

3. **ë¡œê·¸ íŒŒì¼ì´ ë„ˆë¬´ í° ê²½ìš°**
   - ë¡œê·¸ ë ˆë²¨ì„ INFO ì´ìƒìœ¼ë¡œ ì¡°ì •
   - ë³´ê´€ ê¸°ê°„ ë‹¨ì¶•
   - ì••ì¶• ê¸°ëŠ¥ í™œìš©

4. **ì„±ëŠ¥ ì €í•˜**
   - ë¡œê·¸ ë ˆë²¨ì„ WARNING ì´ìƒìœ¼ë¡œ ì¡°ì •
   - ì‹¤ì‹œê°„ ë¡œê·¸ ìˆ˜ë¥¼ ì¤„ì„
   - ë¹„ë™ê¸° ë¡œê¹… ê³ ë ¤

## ğŸ“ˆ ë¡œê·¸ ë¶„ì„ í™œìš© ì‚¬ë¡€

### 1. ë§¤ë§¤ ì„±ê³¼ ê°œì„ 
```python
# ì‹œê°„ëŒ€ë³„ ë§¤ë§¤ ì„±ê³¼ ë¶„ì„
trading_data = analyzer.analyze_trading_performance()
buy_df = trading_data['buy_orders']

# ì‹œê°„ëŒ€ë³„ ë§¤ìˆ˜ ê±´ìˆ˜
hourly_buys = buy_df.groupby(buy_df['timestamp'].dt.hour).size()
print("ì‹œê°„ëŒ€ë³„ ë§¤ìˆ˜ ê±´ìˆ˜:")
print(hourly_buys)
```

### 2. ì‹œìŠ¤í…œ ì•ˆì •ì„± ëª¨ë‹ˆí„°ë§
```python
# ì—ëŸ¬ ë°œìƒ íŒ¨í„´ ë¶„ì„
error_data = analyzer.analyze_error_patterns(days_back=30)

# ì—ëŸ¬ ê¸‰ì¦ êµ¬ê°„ ì°¾ê¸°
error_df = error_data['details']
daily_errors = error_df.groupby('date').size()
print("ì¼ë³„ ì—ëŸ¬ ë°œìƒ ìˆ˜:")
print(daily_errors.sort_values(ascending=False))
```

### 3. API ì‚¬ìš©ëŸ‰ ìµœì í™”
```python
# TR ìš”ì²­ íŒ¨í„´ ë¶„ì„
performance = analyzer.analyze_system_performance()
tr_times = performance['tr_request_times']

# ì‹œê°„ëŒ€ë³„ ìš”ì²­ ë¶„í¬
from collections import Counter
hourly_requests = Counter(tr_times)
print("ì‹œê°„ëŒ€ë³„ TR ìš”ì²­ ìˆ˜:")
for hour in sorted(hourly_requests.keys()):
    print(f"{hour:02d}ì‹œ: {hourly_requests[hour]}ê±´")
```

## ğŸ¯ ì¶”ì²œ ì›Œí¬í”Œë¡œìš°

1. **ë§¤ì¼ ì•„ì¹¨**: ì „ë‚  ì¼ì¼ ë¦¬í¬íŠ¸ í™•ì¸
2. **ë§¤ë§¤ ì‹œê°„ ì¤‘**: ì—ëŸ¬ ë¡œê·¸ ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§
3. **ë§¤ë§¤ ì¢…ë£Œ í›„**: ë§¤ë§¤ ì„±ê³¼ ë¶„ì„ ë° ì°¨íŠ¸ í™•ì¸
4. **ì£¼ê°„**: ì—ëŸ¬ íŒ¨í„´ ë¶„ì„ ë° ì‹œìŠ¤í…œ ìµœì í™”
5. **ì›”ê°„**: ì „ì²´ ì„±ê³¼ ë¦¬ë·° ë° ë¡œê·¸ ë³´ê´€ ì •ì±… ê²€í† 

ì´ ë¡œê·¸ ì‹œìŠ¤í…œì„ í†µí•´ ìë™ë§¤ë§¤ í”„ë¡œê·¸ë¨ì˜ ìƒíƒœë¥¼ ì •í™•íˆ íŒŒì•…í•˜ê³ , ë¬¸ì œ ë°œìƒ ì‹œ ë¹ ë¥¸ ëŒ€ì‘ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.